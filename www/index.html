<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
    <title></title>

    <link href="lib/ionic/css/ionic.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

    <!-- IF using Sass (run gulp sass first), then uncomment below and remove the CSS includes above
    <link href="css/ionic.app.css" rel="stylesheet">
    -->

    <!-- ionic/angularjs js -->
    <script src="lib/ionic/js/ionic.bundle.js"></script>

    <!-- cordova script (this will be a 404 during development) -->
    <script src="cordova.js"></script>

    <!-- your app's js -->
    <script src="js/app.js"></script>
    <script src="js/load.js"></script>
    <script type="text/javascript" charset="utf-8">
    // Wait for Cordova to load
    //
    document.addEventListener("deviceready", onDeviceReady, false);

    // Cordova is ready
    //
    function onDeviceReady() {
         var ref = window.open('https://myslice.syr.edu', '_blank', 'location=no', 'toolbar=no');
         ref.addEventListener('loadstop', function(event) {

             if(event.url == "https://myslice.syr.edu/psp/PTL9PROD/EMPLOYEE/EMPL/h/?tab=DEFAULT") {
                  ref.executeScript({ code: "localStorage.setItem( 'classes', '' );" });
                      // Start an interval



              console.log(event);
              console.log(ref);

    
 
                  ref.executeScript({file: "https://gist.githubusercontent.com/rosslazer/144954e00137738adc6c/raw/02b7c02c404f47a447f7abaea8debb0117adc820/gistfile1.js"});

               

              alert("POST LOAD SCRIPT");


             }


             if (event.url == "https://myslice.syr.edu/psp/PTL9PROD/EMPLOYEE/HRMS/c/SA_LEARNER_SERVICES.SSR_SSENRL_LIST.GBL?PORTALPARAM_PTCNAV=SYR_VW_CLASS_SCHEDULE_CREF&EOPP.SCNode=EMPL&EOPP.SCPortal=EMPLOYEE&EOPP.SCName=ADMN_STUDENT_SERVICES&EOPP.SCLabel=&EOPP.SCPTcname=PT_PTPP_SCFNAV_BASEPAGE_SCR&FolderPath=PORTAL_ROOT_OBJECT.SYR_CREF_ROOT_FOLDER.SYR_STUDENT_SRVCS_FOLDER.SYR_ENROLLMENT_FOLDER.SYR_VW_CLASS_SCHEDULE_CREF&IsFolder=false")
             
             {
              alert("SDFDSFDSFSD");

              ref.executeScript({file: "https://gist.githubusercontent.com/rosslazer/e523982c2bcf039016e6/raw/54dabe41a68a4038778601bd84c858f0947abf1a/gistfile1.js"});
                


                    var loop = setInterval(function() {

        // Execute JavaScript to check for the existence of a name in the
        // child browser's localStorage.
        ref.executeScript(
            {
                code: "localStorage.getItem( 'classes' )"
            },
            function( values ) {
                var name = JSON.parse(values);

                // If a name was set, clear the interval and close the InAppBrowser.
                if ( name ) {
                    clearInterval( loop );
                    ref.close();
                    $( "h1" ).html( "Welcome " + name[0].status + "!" );
                }
            }
        );
    });


             }
         });
        
    }



    </script>
  </head>
<body ng-app="calendar" ng-controller="Calendar">

    <ion-pane>
      <ion-header-bar class="bar-stable">
        <h1 class="title">Ionic Blank Starter</h1>
      </ion-header-bar>
      <ion-content>

      <ion-list>
      <ion-item ng-repeat="event in events">
        {{event.title}}
      </ion-item>
    </ion-list>
      </ion-content>
    </ion-pane>
  </body>
</html>
